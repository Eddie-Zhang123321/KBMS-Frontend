import{u as U,b as z,d as b,e as y,r as l,c as E,o as N,a as o,f as t,w as s,g as k,h as q,l as D,i,j as I,E as u}from"./index-BsXkJmm5.js";import{_ as K}from"./logo-RMEbkNKP.js";import{C as M}from"./CubeBackground-DVSVkm-0.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"back"},S={class:"login-container"},j={class:"login-card"},T={class:"login-footer"},A={__name:"Login",setup(G){const c=U(),d=z(),r=b({email:"",password:""}),V=b({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在6到20个字符",trigger:"blur"}]}),p=y(!1),m=y(!1),_=async()=>{try{m.value=!0,await d.login(r);try{await d.fetchPreferences()}catch(a){console.warn("Failed to fetch preferences after login:",a)}u.success("登录成功"),c.push(d.defaultPage)}catch(a){const e=a?.message||a?.data?.message||a?.response?.data?.message||"登录失败";u.error(e)}finally{m.value=!1}},x=()=>{u.info("请联系管理员重置密码")},h=()=>{c.push("/register")};return(a,e)=>{const g=l("el-icon"),f=l("el-input"),w=l("el-form-item"),C=l("el-checkbox"),B=l("el-button"),F=l("el-form"),v=l("el-link"),L=l("el-divider");return N(),E("div",R,[o(M),t("div",S,[t("div",j,[e[7]||(e[7]=t("div",{class:"login-header"},[t("img",{src:K,alt:"Logo",class:"logo"}),t("h1",null,"InsightFlow"),t("p",null,"请输入您的账号密码")],-1)),o(F,{ref:"loginForm",model:r,rules:V,onKeyup:I(_,["enter"])},{default:s(()=>[o(w,{prop:"email"},{default:s(()=>[o(f,{modelValue:r.email,"onUpdate:modelValue":e[0]||(e[0]=n=>r.email=n),placeholder:"请输入邮箱",size:"large"},{prefix:s(()=>[o(g,null,{default:s(()=>[o(k(q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(w,{prop:"password"},{default:s(()=>[o(f,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=n=>r.password=n),type:"password",placeholder:"请输入密码",size:"large","show-password":""},{prefix:s(()=>[o(g,null,{default:s(()=>[o(k(D))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(C,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=n=>p.value=n),class:"remember-me"},{default:s(()=>e[3]||(e[3]=[i("记住我")])),_:1,__:[3]},8,["modelValue"]),o(B,{type:"primary",size:"large",class:"login-btn",loading:m.value,onClick:_},{default:s(()=>e[4]||(e[4]=[i(" 登 录 ")])),_:1,__:[4]},8,["loading"])]),_:1},8,["model","rules"]),t("div",T,[o(v,{type:"info",onClick:x},{default:s(()=>e[5]||(e[5]=[i("忘记密码?")])),_:1,__:[5]}),o(L,{direction:"vertical"}),o(v,{type:"primary",onClick:h},{default:s(()=>e[6]||(e[6]=[i("注册账号")])),_:1,__:[6]})])])])])}}},W=P(A,[["__scopeId","data-v-e91ce93c"]]);export{W as default};
