import{u as z,b as B,d as v,e as y,r,c as E,o as M,f as s,a as o,w as l,g as b,h as N,l as q,i as d,j as D,E as u}from"./index-D3azu4XD.js";import{_ as I}from"./logo-RMEbkNKP.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"back"},R={class:"login-container"},S={class:"login-card"},j={class:"login-footer"},T={__name:"Login",setup(A){const V=z(),i=B(),a=v({email:"",password:""}),k=v({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在6到20个字符",trigger:"blur"}]}),c=y(!1),m=y(!1),p=async()=>{try{m.value=!0,await i.login(a);try{await i.fetchMe()}catch(t){console.warn("Failed to fetch user details after login:",t)}try{await i.fetchPreferences()}catch(t){console.warn("Failed to fetch preferences after login:",t)}u.success("登录成功"),V.push(i.defaultPage)}catch(t){const e=t?.message||t?.data?.message||t?.response?.data?.message||"登录失败";u.error(e)}finally{m.value=!1}},x=()=>{u.info("请联系管理员重置密码")},h=()=>{u.info("请联系管理员开通账号")};return(t,e)=>{const _=r("el-icon"),f=r("el-input"),g=r("el-form-item"),C=r("el-checkbox"),F=r("el-button"),L=r("el-form"),w=r("el-link"),U=r("el-divider");return M(),E("div",P,[s("div",R,[s("div",S,[e[7]||(e[7]=s("div",{class:"login-header"},[s("img",{src:I,alt:"Logo",class:"logo"}),s("h1",null,"InsightFlow"),s("p",null,"请输入您的账号密码")],-1)),o(L,{ref:"loginForm",model:a,rules:k,onKeyup:D(p,["enter"])},{default:l(()=>[o(g,{prop:"email"},{default:l(()=>[o(f,{modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=n=>a.email=n),placeholder:"请输入邮箱",size:"large"},{prefix:l(()=>[o(_,null,{default:l(()=>[o(b(N))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(g,{prop:"password"},{default:l(()=>[o(f,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=n=>a.password=n),type:"password",placeholder:"请输入密码",size:"large","show-password":""},{prefix:l(()=>[o(_,null,{default:l(()=>[o(b(q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(C,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=n=>c.value=n),class:"remember-me"},{default:l(()=>e[3]||(e[3]=[d("记住我")])),_:1,__:[3]},8,["modelValue"]),o(F,{type:"primary",size:"large",class:"login-btn",loading:m.value,onClick:p},{default:l(()=>e[4]||(e[4]=[d(" 登 录 ")])),_:1,__:[4]},8,["loading"])]),_:1},8,["model","rules"]),s("div",j,[o(w,{type:"info",onClick:x},{default:l(()=>e[5]||(e[5]=[d("忘记密码?")])),_:1,__:[5]}),o(U,{direction:"vertical"}),o(w,{type:"primary",onClick:h},{default:l(()=>e[6]||(e[6]=[d("注册账号")])),_:1,__:[6]})])]),e[8]||(e[8]=s("div",{class:"decoration-circle circle-1"},null,-1)),e[9]||(e[9]=s("div",{class:"decoration-circle circle-2"},null,-1))])])}}},O=K(T,[["__scopeId","data-v-929aa4a1"]]);export{O as default};
