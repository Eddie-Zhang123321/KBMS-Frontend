import{u as z,b as B,d as w,e as b,r as t,c as E,o as N,f as s,a as o,w as l,g as y,h as q,l as D,i,j as I,E as d}from"./index-CxOdaYXd.js";import{_ as K}from"./logo-RMEbkNKP.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"back"},R={class:"login-container"},S={class:"login-card"},j={class:"login-footer"},T={__name:"Login",setup(A){const V=z(),u=B(),r=w({email:"",password:""}),k=w({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在6到20个字符",trigger:"blur"}]}),c=b(!1),m=b(!1),p=async()=>{try{m.value=!0,await u.login(r);try{await u.fetchPreferences()}catch(a){console.warn("Failed to fetch preferences after login:",a)}d.success("登录成功"),V.push(u.defaultPage)}catch(a){const e=a?.message||a?.data?.message||a?.response?.data?.message||"登录失败";d.error(e)}finally{m.value=!1}},x=()=>{d.info("请联系管理员重置密码")},C=()=>{d.info("请联系管理员开通账号")};return(a,e)=>{const _=t("el-icon"),g=t("el-input"),f=t("el-form-item"),h=t("el-checkbox"),F=t("el-button"),L=t("el-form"),v=t("el-link"),U=t("el-divider");return N(),E("div",P,[s("div",R,[s("div",S,[e[7]||(e[7]=s("div",{class:"login-header"},[s("img",{src:K,alt:"Logo",class:"logo"}),s("h1",null,"InsightFlow"),s("p",null,"请输入您的账号密码")],-1)),o(L,{ref:"loginForm",model:r,rules:k,onKeyup:I(p,["enter"])},{default:l(()=>[o(f,{prop:"email"},{default:l(()=>[o(g,{modelValue:r.email,"onUpdate:modelValue":e[0]||(e[0]=n=>r.email=n),placeholder:"请输入邮箱",size:"large"},{prefix:l(()=>[o(_,null,{default:l(()=>[o(y(q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(f,{prop:"password"},{default:l(()=>[o(g,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=n=>r.password=n),type:"password",placeholder:"请输入密码",size:"large","show-password":""},{prefix:l(()=>[o(_,null,{default:l(()=>[o(y(D))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=n=>c.value=n),class:"remember-me"},{default:l(()=>e[3]||(e[3]=[i("记住我")])),_:1,__:[3]},8,["modelValue"]),o(F,{type:"primary",size:"large",class:"login-btn",loading:m.value,onClick:p},{default:l(()=>e[4]||(e[4]=[i(" 登 录 ")])),_:1,__:[4]},8,["loading"])]),_:1},8,["model","rules"]),s("div",j,[o(v,{type:"info",onClick:x},{default:l(()=>e[5]||(e[5]=[i("忘记密码?")])),_:1,__:[5]}),o(U,{direction:"vertical"}),o(v,{type:"primary",onClick:C},{default:l(()=>e[6]||(e[6]=[i("注册账号")])),_:1,__:[6]})])]),e[8]||(e[8]=s("div",{class:"decoration-circle circle-1"},null,-1)),e[9]||(e[9]=s("div",{class:"decoration-circle circle-2"},null,-1))])])}}},O=M(T,[["__scopeId","data-v-188501d9"]]);export{O as default};
