import{b as O,A as M,d as T,r as f,c as j,o as B,C as L,D as Q,w as l,a as t,f as d,i,E as x}from"./index-BsXkJmm5.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"system-settings"},z={class:"inline-inputs"},G={class:"actions"},J={class:"actions"},I={__name:"SystemSettings",setup(W){const S=O(),h=M(()=>S.platformAdmin),C=M(()=>S.tenantSuperAdmin),V={securityAuth:{tokenMin:30,tokenMax:1440,maxLoginFailures:10,passwordStrength:"medium"},systemBehavior:{maxUploadSizeMB:200,allowBatchUpload:!0,logRetentionDaysMax:365},tenantQuota:{kbLimitPerTenant:100,userLimitPerTenant:2e3,storageLimitPerTenantGB:500},advancedControls:{allowSelfRegister:!1,enableKbEmbed:!0}},_={securityAuth:{tokenMinutes:60,maxLoginFailures:5,passwordStrength:"medium"},systemBehavior:{singleFileMaxUploadMB:150,logRetentionDays:180},tenantQuota:{kbLimit:50,userLimit:800},featureToggles:{allowSelfRegister:!1,userEditable:!0,enableKbEmbed:!0}},o=T(JSON.parse(JSON.stringify(V))),n=T(JSON.parse(JSON.stringify(_))),k={low:1,medium:2,high:3};function R(){const r=o,e=n,s=[];return(e.securityAuth.tokenMinutes<r.securityAuth.tokenMin||e.securityAuth.tokenMinutes>r.securityAuth.tokenMax)&&s.push("租户 token 有效期需在平台设置范围内"),e.securityAuth.maxLoginFailures>r.securityAuth.maxLoginFailures&&s.push("租户最大登录失败次数不得超过平台上限"),k[e.securityAuth.passwordStrength]<k[r.securityAuth.passwordStrength]&&s.push("租户密码强度不得低于平台最低要求"),e.systemBehavior.singleFileMaxUploadMB>r.systemBehavior.maxUploadSizeMB&&s.push("租户单文件上传大小上限不得超过平台上限"),e.systemBehavior.logRetentionDays>r.systemBehavior.logRetentionDaysMax&&s.push("租户日志保留天数不得超过平台上限"),e.tenantQuota.kbLimit>r.tenantQuota.kbLimitPerTenant&&s.push("租户知识库数量限制不得超过平台上限"),e.tenantQuota.userLimit>r.tenantQuota.userLimitPerTenant&&s.push("租户用户数量限制不得超过平台上限"),e.featureToggles.allowSelfRegister&&!r.advancedControls.allowSelfRegister&&s.push("平台未开放自主注册，租户不可开启"),e.featureToggles.enableKbEmbed&&!r.advancedControls.enableKbEmbed&&s.push("平台未启用外部嵌入，租户不可开启"),s}function P(){x.success("平台设置已保存")}function E(){Object.assign(o.securityAuth,V.securityAuth),Object.assign(o.systemBehavior,V.systemBehavior),Object.assign(o.tenantQuota,V.tenantQuota),Object.assign(o.advancedControls,V.advancedControls),x.success("已恢复平台默认值")}function F(){const r=R();if(r.length){x.error(r.join("；"));return}x.success("租户设置已保存")}function D(){Object.assign(n.securityAuth,_.securityAuth),Object.assign(n.systemBehavior,_.systemBehavior),Object.assign(n.tenantQuota,_.tenantQuota),Object.assign(n.featureToggles,_.featureToggles),x.success("已恢复租户默认值")}return(r,e)=>{const s=f("el-input-number"),u=f("el-form-item"),v=f("el-option"),A=f("el-select"),g=f("el-form"),p=f("el-card"),b=f("el-col"),m=f("el-radio"),y=f("el-radio-group"),U=f("el-row"),w=f("el-button");return B(),j("div",N,[h.value?(B(),L(p,{key:0,class:"settings-card",shadow:"hover"},{header:l(()=>e[22]||(e[22]=[d("div",{class:"card-header"},[d("span",null,"平台管理员设置（全局规则 + 上限阈值）")],-1)])),default:l(()=>[t(U,{gutter:16},{default:l(()=>[t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[23]||(e[23]=[d("span",null,"安全与认证",-1)])),default:l(()=>[t(g,{model:o.securityAuth,"label-width":"160px"},{default:l(()=>[t(u,{label:"token有效范围（分钟）"},{default:l(()=>[d("div",z,[e[24]||(e[24]=d("span",null,"最小值：",-1)),t(s,{modelValue:o.securityAuth.tokenMin,"onUpdate:modelValue":e[0]||(e[0]=a=>o.securityAuth.tokenMin=a),min:1,max:1e5},null,8,["modelValue"]),e[25]||(e[25]=d("span",{class:"spacer"},null,-1)),e[26]||(e[26]=d("span",null,"最大值：",-1)),t(s,{modelValue:o.securityAuth.tokenMax,"onUpdate:modelValue":e[1]||(e[1]=a=>o.securityAuth.tokenMax=a),min:o.securityAuth.tokenMin,max:2e5},null,8,["modelValue","min"])])]),_:1}),t(u,{label:"最大登录失败次数上限"},{default:l(()=>[t(s,{modelValue:o.securityAuth.maxLoginFailures,"onUpdate:modelValue":e[2]||(e[2]=a=>o.securityAuth.maxLoginFailures=a),min:1,max:100},null,8,["modelValue"])]),_:1}),t(u,{label:"密码强度最低要求"},{default:l(()=>[t(A,{modelValue:o.securityAuth.passwordStrength,"onUpdate:modelValue":e[3]||(e[3]=a=>o.securityAuth.passwordStrength=a),placeholder:"请选择"},{default:l(()=>[t(v,{label:"低",value:"low"}),t(v,{label:"中",value:"medium"}),t(v,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[27]||(e[27]=[d("span",null,"系统行为",-1)])),default:l(()=>[t(g,{model:o.systemBehavior,"label-width":"180px"},{default:l(()=>[t(u,{label:"上传文件大小上限（MB）"},{default:l(()=>[t(s,{modelValue:o.systemBehavior.maxUploadSizeMB,"onUpdate:modelValue":e[4]||(e[4]=a=>o.systemBehavior.maxUploadSizeMB=a),min:1,max:102400},null,8,["modelValue"])]),_:1}),t(u,{label:"是否允许批量上传"},{default:l(()=>[t(y,{modelValue:o.systemBehavior.allowBatchUpload,"onUpdate:modelValue":e[5]||(e[5]=a=>o.systemBehavior.allowBatchUpload=a)},{default:l(()=>[t(m,{value:!0},{default:l(()=>e[28]||(e[28]=[i("开启")])),_:1,__:[28]}),t(m,{value:!1},{default:l(()=>e[29]||(e[29]=[i("关闭")])),_:1,__:[29]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"日志保留天数上限"},{default:l(()=>[t(s,{modelValue:o.systemBehavior.logRetentionDaysMax,"onUpdate:modelValue":e[6]||(e[6]=a=>o.systemBehavior.logRetentionDaysMax=a),min:1,max:3650},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[30]||(e[30]=[d("span",null,"租户配额",-1)])),default:l(()=>[t(g,{model:o.tenantQuota,"label-width":"220px"},{default:l(()=>[t(u,{label:"单租户最大知识库数上限"},{default:l(()=>[t(s,{modelValue:o.tenantQuota.kbLimitPerTenant,"onUpdate:modelValue":e[7]||(e[7]=a=>o.tenantQuota.kbLimitPerTenant=a),min:1,max:1e5},null,8,["modelValue"])]),_:1}),t(u,{label:"单租户最大用户数上限"},{default:l(()=>[t(s,{modelValue:o.tenantQuota.userLimitPerTenant,"onUpdate:modelValue":e[8]||(e[8]=a=>o.tenantQuota.userLimitPerTenant=a),min:1,max:1e6},null,8,["modelValue"])]),_:1}),t(u,{label:"单租户最大存储容量上限（GB）"},{default:l(()=>[t(s,{modelValue:o.tenantQuota.storageLimitPerTenantGB,"onUpdate:modelValue":e[9]||(e[9]=a=>o.tenantQuota.storageLimitPerTenantGB=a),min:1,max:1048576},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[31]||(e[31]=[d("span",null,"高级功能控制",-1)])),default:l(()=>[t(g,{model:o.advancedControls,"label-width":"220px"},{default:l(()=>[t(u,{label:"是否开放自主注册"},{default:l(()=>[t(y,{modelValue:o.advancedControls.allowSelfRegister,"onUpdate:modelValue":e[10]||(e[10]=a=>o.advancedControls.allowSelfRegister=a)},{default:l(()=>[t(m,{value:!0},{default:l(()=>e[32]||(e[32]=[i("开启")])),_:1,__:[32]}),t(m,{value:!1},{default:l(()=>e[33]||(e[33]=[i("关闭")])),_:1,__:[33]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"是否启用知识库外部嵌入"},{default:l(()=>[t(y,{modelValue:o.advancedControls.enableKbEmbed,"onUpdate:modelValue":e[11]||(e[11]=a=>o.advancedControls.enableKbEmbed=a)},{default:l(()=>[t(m,{value:!0},{default:l(()=>e[34]||(e[34]=[i("开启")])),_:1,__:[34]}),t(m,{value:!1},{default:l(()=>e[35]||(e[35]=[i("关闭")])),_:1,__:[35]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),d("div",G,[t(w,{onClick:E},{default:l(()=>e[36]||(e[36]=[i("恢复默认值")])),_:1,__:[36]}),t(w,{type:"primary",onClick:P},{default:l(()=>e[37]||(e[37]=[i("保存设置")])),_:1,__:[37]})])]),_:1})):Q("",!0),C.value?(B(),L(p,{key:1,class:"settings-card",shadow:"hover"},{header:l(()=>e[38]||(e[38]=[d("div",{class:"card-header"},[d("span",null,"此租户超级管理员设置（在平台范围内细化）")],-1)])),default:l(()=>[t(U,{gutter:16},{default:l(()=>[t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[39]||(e[39]=[d("span",null,"安全与认证",-1)])),default:l(()=>[t(g,{model:n.securityAuth,"label-width":"180px"},{default:l(()=>[t(u,{label:"token有效期（分钟）"},{default:l(()=>[t(s,{modelValue:n.securityAuth.tokenMinutes,"onUpdate:modelValue":e[12]||(e[12]=a=>n.securityAuth.tokenMinutes=a),min:1,max:2e5},null,8,["modelValue"])]),_:1}),t(u,{label:"最大登录失败次数"},{default:l(()=>[t(s,{modelValue:n.securityAuth.maxLoginFailures,"onUpdate:modelValue":e[13]||(e[13]=a=>n.securityAuth.maxLoginFailures=a),min:1,max:100},null,8,["modelValue"])]),_:1}),t(u,{label:"密码强度最低"},{default:l(()=>[t(A,{modelValue:n.securityAuth.passwordStrength,"onUpdate:modelValue":e[14]||(e[14]=a=>n.securityAuth.passwordStrength=a),placeholder:"请选择"},{default:l(()=>[t(v,{label:"低",value:"low"}),t(v,{label:"中",value:"medium"}),t(v,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[40]||(e[40]=[d("span",null,"系统行为",-1)])),default:l(()=>[t(g,{model:n.systemBehavior,"label-width":"220px"},{default:l(()=>[t(u,{label:"单个文件上传大小上限（MB）"},{default:l(()=>[t(s,{modelValue:n.systemBehavior.singleFileMaxUploadMB,"onUpdate:modelValue":e[15]||(e[15]=a=>n.systemBehavior.singleFileMaxUploadMB=a),min:1,max:102400},null,8,["modelValue"])]),_:1}),t(u,{label:"日志保留天数"},{default:l(()=>[t(s,{modelValue:n.systemBehavior.logRetentionDays,"onUpdate:modelValue":e[16]||(e[16]=a=>n.systemBehavior.logRetentionDays=a),min:1,max:3650},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[41]||(e[41]=[d("span",null,"租户配额",-1)])),default:l(()=>[t(g,{model:n.tenantQuota,"label-width":"200px"},{default:l(()=>[t(u,{label:"知识库数量限制"},{default:l(()=>[t(s,{modelValue:n.tenantQuota.kbLimit,"onUpdate:modelValue":e[17]||(e[17]=a=>n.tenantQuota.kbLimit=a),min:1,max:1e5},null,8,["modelValue"])]),_:1}),t(u,{label:"用户数量限制"},{default:l(()=>[t(s,{modelValue:n.tenantQuota.userLimit,"onUpdate:modelValue":e[18]||(e[18]=a=>n.tenantQuota.userLimit=a),min:1,max:1e6},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(b,{span:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[42]||(e[42]=[d("span",null,"功能开关",-1)])),default:l(()=>[t(g,{model:n.featureToggles,"label-width":"240px"},{default:l(()=>[t(u,{label:"是否允许自主注册"},{default:l(()=>[t(y,{modelValue:n.featureToggles.allowSelfRegister,"onUpdate:modelValue":e[19]||(e[19]=a=>n.featureToggles.allowSelfRegister=a)},{default:l(()=>[t(m,{value:!0},{default:l(()=>e[43]||(e[43]=[i("开启")])),_:1,__:[43]}),t(m,{value:!1},{default:l(()=>e[44]||(e[44]=[i("关闭")])),_:1,__:[44]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"用户信息是否可编辑"},{default:l(()=>[t(y,{modelValue:n.featureToggles.userEditable,"onUpdate:modelValue":e[20]||(e[20]=a=>n.featureToggles.userEditable=a)},{default:l(()=>[t(m,{value:!0},{default:l(()=>e[45]||(e[45]=[i("开启")])),_:1,__:[45]}),t(m,{value:!1},{default:l(()=>e[46]||(e[46]=[i("关闭")])),_:1,__:[46]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"是否启用知识库外部嵌入"},{default:l(()=>[t(y,{modelValue:n.featureToggles.enableKbEmbed,"onUpdate:modelValue":e[21]||(e[21]=a=>n.featureToggles.enableKbEmbed=a)},{default:l(()=>[t(m,{value:!0},{default:l(()=>e[47]||(e[47]=[i("开启")])),_:1,__:[47]}),t(m,{value:!1},{default:l(()=>e[48]||(e[48]=[i("关闭")])),_:1,__:[48]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),d("div",J,[t(w,{onClick:D},{default:l(()=>e[49]||(e[49]=[i("恢复默认值")])),_:1,__:[49]}),t(w,{type:"primary",onClick:F},{default:l(()=>e[50]||(e[50]=[i("保存设置")])),_:1,__:[50]})])]),_:1})):Q("",!0)])}}},X=K(I,[["__scopeId","data-v-ea0abc5c"]]);export{X as default};
