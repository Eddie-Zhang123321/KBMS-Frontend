import{b as J,m as w,e as E,d as R,r as f,c as $,o as B,p as F,q as Q,w as l,a as t,f as r,i,E as b}from"./index-CxOdaYXd.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"system-settings"},j={class:"inline-inputs"},q={class:"actions"},I={class:"actions"},H={__name:"SystemSettings",setup(W){const S=J(),P=w(()=>S.platformAdmin),C=w(()=>S.tenantSuperAdmin),x=E(null),_=E(null),M={securityAuth:{tokenMin:30,tokenMax:1440,maxLoginFailures:10,passwordStrength:"medium"},systemBehavior:{maxUploadSizeMB:200,allowBatchUpload:!0,logRetentionDaysMax:365},tenantQuota:{kbLimitPerTenant:100,userLimitPerTenant:2e3,storageLimitPerTenantGB:500},advancedControls:{allowSelfRegister:!1,enableKbEmbed:!0}},U={securityAuth:{tokenMinutes:60,maxLoginFailures:5,passwordStrength:"medium"},systemBehavior:{singleFileMaxUploadMB:150,logRetentionDays:180},tenantQuota:{kbLimit:50,userLimit:800},featureToggles:{allowSelfRegister:!1,userEditable:!0,enableKbEmbed:!0}},a=R(JSON.parse(JSON.stringify(M))),s=R(JSON.parse(JSON.stringify(U))),A={low:1,medium:2,high:3},D=w(()=>({"securityAuth.tokenMinutes":[{validator:(m,e,n)=>{e<a.securityAuth.tokenMin||e>a.securityAuth.tokenMax?n(new Error(`租户 token 有效期需在 ${a.securityAuth.tokenMin} - ${a.securityAuth.tokenMax} 分钟范围内`)):n()},trigger:"blur"}],"securityAuth.maxLoginFailures":[{validator:(m,e,n)=>{e>a.securityAuth.maxLoginFailures?n(new Error(`租户最大登录失败次数不得超过平台上限 ${a.securityAuth.maxLoginFailures}`)):n()},trigger:"blur"}],"securityAuth.passwordStrength":[{validator:(m,e,n)=>{A[e]<A[a.securityAuth.passwordStrength]?n(new Error(`租户密码强度不得低于平台最低要求（${a.securityAuth.passwordStrength}）`)):n()},trigger:"change"}],"systemBehavior.singleFileMaxUploadMB":[{validator:(m,e,n)=>{e>a.systemBehavior.maxUploadSizeMB?n(new Error(`租户单文件上传大小上限不得超过平台上限 ${a.systemBehavior.maxUploadSizeMB} MB`)):n()},trigger:"blur"}],"systemBehavior.logRetentionDays":[{validator:(m,e,n)=>{e>a.systemBehavior.logRetentionDaysMax?n(new Error(`租户日志保留天数不得超过平台上限 ${a.systemBehavior.logRetentionDaysMax} 天`)):n()},trigger:"blur"}],"tenantQuota.kbLimit":[{validator:(m,e,n)=>{e>a.tenantQuota.kbLimitPerTenant?n(new Error(`租户知识库数量限制不得超过平台上限 ${a.tenantQuota.kbLimitPerTenant}`)):n()},trigger:"blur"}],"tenantQuota.userLimit":[{validator:(m,e,n)=>{e>a.tenantQuota.userLimitPerTenant?n(new Error(`租户用户数量限制不得超过平台上限 ${a.tenantQuota.userLimitPerTenant}`)):n()},trigger:"blur"}],"featureToggles.allowSelfRegister":[{validator:(m,e,n)=>{e&&!a.advancedControls.allowSelfRegister?n(new Error("平台未开放自主注册，租户不可开启")):n()},trigger:"change"}],"featureToggles.enableKbEmbed":[{validator:(m,e,n)=>{e&&!a.advancedControls.enableKbEmbed?n(new Error("平台未启用外部嵌入，租户不可开启")):n()},trigger:"change"}]}));async function N(){if(x.value)try{await x.value.validate(),b.success("平台设置已保存")}catch{b.error("表单校验失败，请检查输入项")}}function O(){Object.assign(a,JSON.parse(JSON.stringify(M))),b.success("已恢复平台默认值")}async function K(){if(_.value)try{await _.value.validate(),b.success("租户设置已保存")}catch{b.error("表单校验失败，请检查输入项")}}function h(){Object.assign(s,JSON.parse(JSON.stringify(U))),b.success("已恢复租户默认值")}return(m,e)=>{const n=f("el-input-number"),u=f("el-form-item"),v=f("el-option"),L=f("el-select"),p=f("el-card"),g=f("el-col"),d=f("el-radio"),y=f("el-radio-group"),k=f("el-row"),V=f("el-button"),T=f("el-form");return B(),$("div",G,[P.value?(B(),F(p,{key:0,class:"settings-card",shadow:"hover"},{header:l(()=>e[22]||(e[22]=[r("div",{class:"card-header"},[r("span",null,"平台管理员设置（全局规则 + 上限阈值）")],-1)])),default:l(()=>[t(T,{ref_key:"platformFormRef",ref:x,model:a},{default:l(()=>[t(k,{gutter:16},{default:l(()=>[t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[23]||(e[23]=[r("span",null,"安全与认证",-1)])),default:l(()=>[t(u,{label:"token有效范围（分钟）"},{default:l(()=>[r("div",j,[e[24]||(e[24]=r("span",null,"最小值：",-1)),t(n,{modelValue:a.securityAuth.tokenMin,"onUpdate:modelValue":e[0]||(e[0]=o=>a.securityAuth.tokenMin=o),min:1,max:1e5,style:{width:"100%"}},null,8,["modelValue"]),e[25]||(e[25]=r("span",{class:"spacer"},null,-1)),e[26]||(e[26]=r("span",null,"最大值：",-1)),t(n,{modelValue:a.securityAuth.tokenMax,"onUpdate:modelValue":e[1]||(e[1]=o=>a.securityAuth.tokenMax=o),min:a.securityAuth.tokenMin,max:2e5,style:{width:"100%"}},null,8,["modelValue","min"])])]),_:1}),t(u,{label:"最大登录失败次数上限"},{default:l(()=>[t(n,{modelValue:a.securityAuth.maxLoginFailures,"onUpdate:modelValue":e[2]||(e[2]=o=>a.securityAuth.maxLoginFailures=o),min:1,max:100},null,8,["modelValue"])]),_:1}),t(u,{label:"密码强度最低要求"},{default:l(()=>[t(L,{modelValue:a.securityAuth.passwordStrength,"onUpdate:modelValue":e[3]||(e[3]=o=>a.securityAuth.passwordStrength=o),placeholder:"请选择"},{default:l(()=>[t(v,{label:"低",value:"low"}),t(v,{label:"中",value:"medium"}),t(v,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[27]||(e[27]=[r("span",null,"系统行为",-1)])),default:l(()=>[t(u,{label:"上传文件大小上限（MB）"},{default:l(()=>[t(n,{modelValue:a.systemBehavior.maxUploadSizeMB,"onUpdate:modelValue":e[4]||(e[4]=o=>a.systemBehavior.maxUploadSizeMB=o),min:1,max:102400},null,8,["modelValue"])]),_:1}),t(u,{label:"是否允许批量上传"},{default:l(()=>[t(y,{modelValue:a.systemBehavior.allowBatchUpload,"onUpdate:modelValue":e[5]||(e[5]=o=>a.systemBehavior.allowBatchUpload=o)},{default:l(()=>[t(d,{value:!0},{default:l(()=>e[28]||(e[28]=[i("开启")])),_:1,__:[28]}),t(d,{value:!1},{default:l(()=>e[29]||(e[29]=[i("关闭")])),_:1,__:[29]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"日志保留天数上限"},{default:l(()=>[t(n,{modelValue:a.systemBehavior.logRetentionDaysMax,"onUpdate:modelValue":e[6]||(e[6]=o=>a.systemBehavior.logRetentionDaysMax=o),min:1,max:3650},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[30]||(e[30]=[r("span",null,"租户配额",-1)])),default:l(()=>[t(u,{label:"单租户最大知识库数上限"},{default:l(()=>[t(n,{modelValue:a.tenantQuota.kbLimitPerTenant,"onUpdate:modelValue":e[7]||(e[7]=o=>a.tenantQuota.kbLimitPerTenant=o),min:1,max:1e5},null,8,["modelValue"])]),_:1}),t(u,{label:"单租户最大用户数上限"},{default:l(()=>[t(n,{modelValue:a.tenantQuota.userLimitPerTenant,"onUpdate:modelValue":e[8]||(e[8]=o=>a.tenantQuota.userLimitPerTenant=o),min:1,max:1e6},null,8,["modelValue"])]),_:1}),t(u,{label:"单租户最大存储容量上限（GB）"},{default:l(()=>[t(n,{modelValue:a.tenantQuota.storageLimitPerTenantGB,"onUpdate:modelValue":e[9]||(e[9]=o=>a.tenantQuota.storageLimitPerTenantGB=o),min:1,max:1048576},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[31]||(e[31]=[r("span",null,"高级功能控制",-1)])),default:l(()=>[t(u,{label:"是否开放自主注册"},{default:l(()=>[t(y,{modelValue:a.advancedControls.allowSelfRegister,"onUpdate:modelValue":e[10]||(e[10]=o=>a.advancedControls.allowSelfRegister=o)},{default:l(()=>[t(d,{value:!0},{default:l(()=>e[32]||(e[32]=[i("开启")])),_:1,__:[32]}),t(d,{value:!1},{default:l(()=>e[33]||(e[33]=[i("关闭")])),_:1,__:[33]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"是否启用知识库外部嵌入"},{default:l(()=>[t(y,{modelValue:a.advancedControls.enableKbEmbed,"onUpdate:modelValue":e[11]||(e[11]=o=>a.advancedControls.enableKbEmbed=o)},{default:l(()=>[t(d,{value:!0},{default:l(()=>e[34]||(e[34]=[i("开启")])),_:1,__:[34]}),t(d,{value:!1},{default:l(()=>e[35]||(e[35]=[i("关闭")])),_:1,__:[35]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r("div",q,[t(V,{onClick:O},{default:l(()=>e[36]||(e[36]=[i("恢复默认值")])),_:1,__:[36]}),t(V,{type:"primary",onClick:N},{default:l(()=>e[37]||(e[37]=[i("保存设置")])),_:1,__:[37]})])]),_:1},8,["model"])]),_:1})):Q("",!0),C.value?(B(),F(p,{key:1,class:"settings-card",shadow:"hover"},{header:l(()=>e[38]||(e[38]=[r("div",{class:"card-header"},[r("span",null,"此租户超级管理员设置（在平台范围内细化）")],-1)])),default:l(()=>[t(T,{ref_key:"tenantFormRef",ref:_,model:s,rules:D.value},{default:l(()=>[t(k,{gutter:16},{default:l(()=>[t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[39]||(e[39]=[r("span",null,"安全与认证",-1)])),default:l(()=>[t(u,{label:"token有效期（分钟）",prop:"securityAuth.tokenMinutes"},{default:l(()=>[t(n,{modelValue:s.securityAuth.tokenMinutes,"onUpdate:modelValue":e[12]||(e[12]=o=>s.securityAuth.tokenMinutes=o),min:1,max:2e5},null,8,["modelValue"])]),_:1}),t(u,{label:"最大登录失败次数",prop:"securityAuth.maxLoginFailures"},{default:l(()=>[t(n,{modelValue:s.securityAuth.maxLoginFailures,"onUpdate:modelValue":e[13]||(e[13]=o=>s.securityAuth.maxLoginFailures=o),min:1,max:100},null,8,["modelValue"])]),_:1}),t(u,{label:"密码强度最低",prop:"securityAuth.passwordStrength"},{default:l(()=>[t(L,{modelValue:s.securityAuth.passwordStrength,"onUpdate:modelValue":e[14]||(e[14]=o=>s.securityAuth.passwordStrength=o),placeholder:"请选择"},{default:l(()=>[t(v,{label:"低",value:"low"}),t(v,{label:"中",value:"medium"}),t(v,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[40]||(e[40]=[r("span",null,"系统行为",-1)])),default:l(()=>[t(u,{label:"单个文件上传大小上限（MB）",prop:"systemBehavior.singleFileMaxUploadMB"},{default:l(()=>[t(n,{modelValue:s.systemBehavior.singleFileMaxUploadMB,"onUpdate:modelValue":e[15]||(e[15]=o=>s.systemBehavior.singleFileMaxUploadMB=o),min:1,max:102400},null,8,["modelValue"])]),_:1}),t(u,{label:"日志保留天数",prop:"systemBehavior.logRetentionDays"},{default:l(()=>[t(n,{modelValue:s.systemBehavior.logRetentionDays,"onUpdate:modelValue":e[16]||(e[16]=o=>s.systemBehavior.logRetentionDays=o),min:1,max:3650},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[41]||(e[41]=[r("span",null,"租户配额",-1)])),default:l(()=>[t(u,{label:"知识库数量限制",prop:"tenantQuota.kbLimit"},{default:l(()=>[t(n,{modelValue:s.tenantQuota.kbLimit,"onUpdate:modelValue":e[17]||(e[17]=o=>s.tenantQuota.kbLimit=o),min:1,max:1e5},null,8,["modelValue"])]),_:1}),t(u,{label:"用户数量限制",prop:"tenantQuota.userLimit"},{default:l(()=>[t(n,{modelValue:s.tenantQuota.userLimit,"onUpdate:modelValue":e[18]||(e[18]=o=>s.tenantQuota.userLimit=o),min:1,max:1e6},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(g,{span:12,xs:24,sm:12},{default:l(()=>[t(p,{class:"section-card",shadow:"never"},{header:l(()=>e[42]||(e[42]=[r("span",null,"功能开关",-1)])),default:l(()=>[t(u,{label:"是否允许自主注册",prop:"featureToggles.allowSelfRegister"},{default:l(()=>[t(y,{modelValue:s.featureToggles.allowSelfRegister,"onUpdate:modelValue":e[19]||(e[19]=o=>s.featureToggles.allowSelfRegister=o)},{default:l(()=>[t(d,{value:!0},{default:l(()=>e[43]||(e[43]=[i("开启")])),_:1,__:[43]}),t(d,{value:!1},{default:l(()=>e[44]||(e[44]=[i("关闭")])),_:1,__:[44]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"用户信息是否可编辑"},{default:l(()=>[t(y,{modelValue:s.featureToggles.userEditable,"onUpdate:modelValue":e[20]||(e[20]=o=>s.featureToggles.userEditable=o)},{default:l(()=>[t(d,{value:!0},{default:l(()=>e[45]||(e[45]=[i("开启")])),_:1,__:[45]}),t(d,{value:!1},{default:l(()=>e[46]||(e[46]=[i("关闭")])),_:1,__:[46]})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"是否启用知识库外部嵌入",prop:"featureToggles.enableKbEmbed"},{default:l(()=>[t(y,{modelValue:s.featureToggles.enableKbEmbed,"onUpdate:modelValue":e[21]||(e[21]=o=>s.featureToggles.enableKbEmbed=o)},{default:l(()=>[t(d,{value:!0},{default:l(()=>e[47]||(e[47]=[i("开启")])),_:1,__:[47]}),t(d,{value:!1},{default:l(()=>e[48]||(e[48]=[i("关闭")])),_:1,__:[48]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r("div",I,[t(V,{onClick:h},{default:l(()=>e[49]||(e[49]=[i("恢复默认值")])),_:1,__:[49]}),t(V,{type:"primary",onClick:K},{default:l(()=>e[50]||(e[50]=[i("保存设置")])),_:1,__:[50]})])]),_:1},8,["model","rules"])]),_:1})):Q("",!0)])}}},Z=z(H,[["__scopeId","data-v-ee95e44f"]]);export{Z as default};
