const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/PlatformAdminStatistics-BuJAm73v.js","static/js/vue-vendor-BUDnSszI.js","static/js/vendor-zcc-V1Og.js","static/css/vendor-CtIGEsJ0.css","static/js/_plugin-vue_export-helper-BCo6x5W8.js","static/js/charts-vendor-9etj8hyj.js","static/css/PlatformAdminStatistics-CtTJiV7q.css","static/js/TenantAdminStatistics-B0pfR5oL.js","static/css/TenantAdminStatistics-DOD6W0u1.css","static/js/UserKnowledgeStatistics-BpxE2MPY.js","static/css/UserKnowledgeStatistics-CPmG3mtp.css"])))=>i.map(i=>d[i]);
import{aL as a,aN as s}from"./vendor-zcc-V1Og.js";import{r as t,d as e,F as i,b1 as l,I as d,J as c,K as v,a1 as n,U as r,X as o,V as u,$ as m,a0 as f,av as p,N as y,u as g,c0 as _,bU as b,Z as w,c1 as k,c2 as h,bG as A,c3 as N,c4 as T,bX as D,bT as S,c5 as E,c6 as x,bq as j,bE as P,aT as I,c7 as O}from"./vue-vendor-BUDnSszI.js";import{u as $}from"./index-8D9d6p3q.js";import{u as B}from"./useWebSocket-CuTw-Xrt.js";import{g as L}from"./ticket-DtMqVmfI.js";import{_ as R}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./network-vendor-ztdpVPaQ.js";const W={class:"dashboard-container"},V={class:"dashboard-layout"},C={class:"notification-section"},U={class:"card-header"},q={key:0,class:"loading-notification"},K={key:1,class:"empty-notification"},M={key:0,class:"last-load-time"},X={class:"notification-content"},z={class:"notification-title"},F={class:"knowledge-base-name"},G={class:"notification-detail"},J={class:"notification-time"},Z={class:"stat-card"},H={class:"stat-icon"},Q={class:"stat-card"},Y={class:"stat-icon"},aa={class:"stat-card"},sa={class:"stat-icon"},ta={class:"stat-card"},ea={class:"stat-icon"},ia={class:"stat-card"},la={class:"stat-icon"},da={class:"stat-card"},ca={class:"stat-icon"},va={key:1,class:"tenant-role-distribution"},na={class:"role-content"},ra={class:"role-item"},oa={class:"role-icon normal-user"},ua={class:"role-item"},ma={class:"role-icon kb-admin"},fa={class:"role-item"},pa={class:"role-icon kb-owner"},ya={class:"role-item"},ga={class:"role-icon super-admin"},_a={key:2,class:"user-dashboard-overview"},ba={class:"overview-content"},wa={class:"activity-item"},ka={class:"activity-icon"},ha={class:"activity-item"},Aa={class:"activity-icon"},Na={class:"activity-item"},Ta={class:"activity-icon"},Da={class:"statistics-section"},Sa=R({__name:"Dashboard",setup(R){const Sa=O(()=>s(()=>import("./PlatformAdminStatistics-BuJAm73v.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ea=O(()=>s(()=>import("./TenantAdminStatistics-B0pfR5oL.js"),__vite__mapDeps([7,1,2,3,4,5,8]))),xa=O(()=>s(()=>import("./UserKnowledgeStatistics-BpxE2MPY.js"),__vite__mapDeps([9,1,2,3,4,5,10]))),ja=$(),{notifications:Pa}=B(),Ia=t([]),Oa=t(!1),$a=t(null),Ba=e(()=>[...Ia.value||[],...Pa.list||[]].filter((a,s,t)=>s===t.findIndex(s=>s.id===a.id)).sort((a,s)=>(s.timestamp||0)-(a.timestamp||0))),La=e(()=>Ba.value),Ra=e(()=>Ba.value.length),Wa=a=>{if(!a)return"";const s=new Date-a,t=Math.floor(s/6e4);if(t<1)return"刚刚";if(t<60)return`${t}分钟前`;const e=Math.floor(t/60);return e<24?`${e}小时前`:a.toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},Va=a=>{return{accuracy:"准确度",relevance:"相关度",completeness:"完整度",clarity:"清晰度"}[s=a.feedbackType]||s||"工单通知";var s},Ca=a=>{const s=[];return a.userName&&s.push(`用户：${a.userName}`),a.type&&s.push(`状态：${Ua(a.type)}`),s.join(" | ")},Ua=a=>"NEW"===a?"新工单":"PROCESSED"===a?"已处理":a||"未知状态",qa=a=>"NEW"===a?"type-new":"PROCESSED"===a?"type-processed":"type-unknown";return i(()=>{(async()=>{try{Oa.value=!0;const s=await L();s?Array.isArray(s)?(Ia.value=s.map(a=>({id:a.id||Date.now(),knowledgeBaseName:a.knowledgeBaseName||"未知知识库",userName:a.userName||"未知用户",feedbackType:a.feedbackType||"工单通知",createdAt:a.createdAt||(new Date).toISOString(),type:a.type||"NEW",timestamp:new Date(a.createdAt||Date.now()).getTime()})),a.success(`成功加载 ${Ia.value.length} 条工单通知`)):s.data&&Array.isArray(s.data)?(Ia.value=s.data.map(a=>({id:a.id||Date.now(),knowledgeBaseName:a.knowledgeBaseName||"未知知识库",userName:a.userName||"未知用户",feedbackType:a.feedbackType||"工单通知",createdAt:a.createdAt||(new Date).toISOString(),type:a.type||"NEW",timestamp:new Date(a.createdAt||Date.now()).getTime()})),a.success(`成功加载 ${Ia.value.length} 条工单通知`)):a.warning("工单通知数据格式异常"):a.warning("未收到工单通知数据"),$a.value=new Date}catch(s){a.error("加载工单通知失败，请检查网络连接")}finally{Oa.value=!1}})()}),(a,s)=>{const t=l("el-icon"),e=l("el-badge"),i=l("el-scrollbar"),O=l("el-card"),$=l("el-col"),B=l("el-row");return c(),d("div",W,[v("div",V,[v("div",C,[n(O,{shadow:"hover",class:"notification-card"},{header:u(()=>[v("div",U,[s[0]||(s[0]=v("span",null,"工单通知",-1)),n(e,{value:Ra.value,max:99,class:"unread-badge"},{default:u(()=>[n(t,null,{default:u(()=>[n(g(_))]),_:1})]),_:1},8,["value"])])]),default:u(()=>[n(i,{class:"notification-list"},{default:u(()=>[Oa.value?(c(),d("div",q,"加载中...")):0===La.value.length?(c(),d("div",K,[s[1]||(s[1]=v("div",null,"暂无工单通知",-1)),$a.value?(c(),d("div",M," 最后更新："+m(Wa($a.value)),1)):o("",!0)])):o("",!0),(c(!0),d(f,null,p(La.value,a=>{return c(),d("div",{key:a.id,class:y(["notification-item",qa(a.type)])},[v("div",X,[v("div",z,[v("span",{class:y(["feedback-type-text",(t=a.feedbackType,"accuracy"===t?"feedback-accuracy":"relevance"===t?"feedback-relevance":"completeness"===t?"feedback-completeness":"clarity"===t?"feedback-clarity":"feedback-default")])},m(Va(a)),3),a.type?(c(),d("span",{key:0,class:y(["type-badge",qa(a.type)])},m(Ua(a.type)),3)):o("",!0)]),v("div",F," 📚 "+m(a.knowledgeBaseName||"未知知识库"),1),v("div",G,m(Ca(a)),1),v("div",J,m((s=a.createdAt,s||"未知时间")),1)])],2);var s,t}),128))]),_:1})]),_:1}),g(ja).isPlatformAdmin?(c(),r(B,{key:0,gutter:8,class:"stats-row platform-stats-row"},{default:u(()=>[n($,{xs:12,sm:12,md:6,lg:6},{default:u(()=>[v("div",Z,[v("div",H,[n(t,null,{default:u(()=>[n(g(b))]),_:1})]),s[2]||(s[2]=v("div",{class:"stat-content"},[v("div",{class:"stat-title"},"登录失败统计"),v("div",{class:"stat-value"},[w("9"),v("span",{class:"stat-unit"},"次")]),v("div",{class:"stat-desc"},"近24h失败数")],-1))])]),_:1}),n($,{xs:12,sm:12,md:6,lg:6},{default:u(()=>[v("div",Q,[v("div",Y,[n(t,null,{default:u(()=>[n(g(k))]),_:1})]),s[3]||(s[3]=v("div",{class:"stat-content"},[v("div",{class:"stat-title"},"API异常率"),v("div",{class:"stat-value"},[w("2"),v("span",{class:"stat-unit"},"%")]),v("div",{class:"stat-desc"},"跨租户占比")],-1))])]),_:1}),n($,{xs:12,sm:12,md:6,lg:6},{default:u(()=>[v("div",aa,[v("div",sa,[n(t,null,{default:u(()=>[n(g(h))]),_:1})]),s[4]||(s[4]=v("div",{class:"stat-content"},[v("div",{class:"stat-title"},"存储使用"),v("div",{class:"stat-value"},[w("2.3"),v("span",{class:"stat-unit"},"TB")]),v("div",{class:"stat-desc"},"平台总存储量")],-1))])]),_:1}),n($,{xs:12,sm:12,md:6,lg:6},{default:u(()=>[v("div",ta,[v("div",ea,[n(t,null,{default:u(()=>[n(g(A))]),_:1})]),s[5]||(s[5]=v("div",{class:"stat-content"},[v("div",{class:"stat-title"},"文档条目"),v("div",{class:"stat-value"},[w("1200"),v("span",{class:"stat-unit"},"条")]),v("div",{class:"stat-desc"},"全平台总量")],-1))])]),_:1}),n($,{xs:12,sm:12,md:6,lg:6},{default:u(()=>[v("div",ia,[v("div",la,[n(t,null,{default:u(()=>[n(g(N))]),_:1})]),s[6]||(s[6]=v("div",{class:"stat-content"},[v("div",{class:"stat-title"},"系统告警"),v("div",{class:"stat-value"},[w("3"),v("span",{class:"stat-unit"},"条")]),v("div",{class:"stat-desc"},"待处理告警")],-1))])]),_:1}),n($,{xs:12,sm:12,md:6,lg:6},{default:u(()=>[v("div",da,[v("div",ca,[n(t,null,{default:u(()=>[n(g(T))]),_:1})]),s[7]||(s[7]=v("div",{class:"stat-content"},[v("div",{class:"stat-title"},"系统响应时间"),v("div",{class:"stat-value"},[w("156"),v("span",{class:"stat-unit"},"ms")]),v("div",{class:"stat-desc"},"平均响应时间")],-1))])]),_:1})]),_:1})):o("",!0),g(ja).isTenantSuperAdmin?(c(),d("div",va,[s[12]||(s[12]=v("div",{class:"role-header"},[v("h3",{class:"role-title"},"租户用户角色分布"),v("div",{class:"role-total"},"总用户数：256人")],-1)),v("div",na,[v("div",ra,[v("div",oa,[n(t,null,{default:u(()=>[n(g(S))]),_:1})]),s[8]||(s[8]=D('<div class="role-info" data-v-0acd606a><div class="role-name" data-v-0acd606a>普通用户</div><div class="role-count" data-v-0acd606a>180人</div><div class="role-percentage" data-v-0acd606a>70.3%</div></div><div class="role-progress" data-v-0acd606a><div class="progress-bar" data-v-0acd606a><div class="progress-fill normal-fill" style="width:70.3%;" data-v-0acd606a></div></div></div>',2))]),v("div",ua,[v("div",ma,[n(t,null,{default:u(()=>[n(g(E))]),_:1})]),s[9]||(s[9]=D('<div class="role-info" data-v-0acd606a><div class="role-name" data-v-0acd606a>知识库管理员</div><div class="role-count" data-v-0acd606a>45人</div><div class="role-percentage" data-v-0acd606a>17.6%</div></div><div class="role-progress" data-v-0acd606a><div class="progress-bar" data-v-0acd606a><div class="progress-fill admin-fill" style="width:17.6%;" data-v-0acd606a></div></div></div>',2))]),v("div",fa,[v("div",pa,[n(t,null,{default:u(()=>[n(g(x))]),_:1})]),s[10]||(s[10]=D('<div class="role-info" data-v-0acd606a><div class="role-name" data-v-0acd606a>知识库所有人</div><div class="role-count" data-v-0acd606a>31人</div><div class="role-percentage" data-v-0acd606a>12.1%</div></div><div class="role-progress" data-v-0acd606a><div class="progress-bar" data-v-0acd606a><div class="progress-fill owner-fill" style="width:12.1%;" data-v-0acd606a></div></div></div>',2))]),v("div",ya,[v("div",ga,[n(t,null,{default:u(()=>[n(g(j))]),_:1})]),s[11]||(s[11]=D('<div class="role-info" data-v-0acd606a><div class="role-name" data-v-0acd606a>超级管理员</div><div class="role-count" data-v-0acd606a>1人</div><div class="role-percentage" data-v-0acd606a>0.4%</div></div><div class="role-progress" data-v-0acd606a><div class="progress-bar" data-v-0acd606a><div class="progress-fill super-fill" style="width:0.4%;" data-v-0acd606a></div></div></div>',2))])])])):o("",!0),g(ja).isPlatformAdmin||g(ja).isTenantSuperAdmin?o("",!0):(c(),d("div",_a,[s[16]||(s[16]=v("div",{class:"overview-header"},[v("h3",{class:"overview-title"},"今日活动")],-1)),v("div",ba,[v("div",wa,[v("div",ka,[n(t,null,{default:u(()=>[n(g(P))]),_:1})]),s[13]||(s[13]=v("div",{class:"activity-info"},[v("div",{class:"activity-label"},"查询次数"),v("div",{class:"activity-value"},"23次")],-1))]),v("div",ha,[v("div",Aa,[n(t,null,{default:u(()=>[n(g(A))]),_:1})]),s[14]||(s[14]=v("div",{class:"activity-info"},[v("div",{class:"activity-label"},"新增文档"),v("div",{class:"activity-value"},"5个")],-1))]),v("div",Na,[v("div",Ta,[n(t,null,{default:u(()=>[n(g(I))]),_:1})]),s[15]||(s[15]=v("div",{class:"activity-info"},[v("div",{class:"activity-label"},"使用时长"),v("div",{class:"activity-value"},"2.5小时")],-1))])])]))]),v("div",Da,[g(ja).isPlatformAdmin?(c(),r(g(Sa),{key:0})):g(ja).isTenantSuperAdmin?(c(),r(g(Ea),{key:1})):(c(),r(g(xa),{key:2}))])])])}}},[["__scopeId","data-v-0acd606a"]]);export{Sa as default};
