import{bS as e,r as a,a as l,b1 as r,I as s,J as t,a1 as o,K as d,V as u,ae as i,u as m,bV as n,bT as p,bW as g,bU as f,Z as c}from"./vue-vendor-BUDnSszI.js";import{_}from"./logo-B9TFvINw.js";import{C as b}from"./CubeBackground-DDxgKxHE.js";import{_ as V}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{aL as h}from"./vendor-zcc-V1Og.js";const v={class:"back"},w={class:"register-container"},y={class:"register-card"},x={class:"register-footer"},N=V({__name:"Register",setup(V){const N=e(),z=a("tenant"),U=l({tenantName:"",superAdmin:"",email:"",password:""}),j=l({userName:"",email:"",code:"",department:"",password:""}),k=l({tenantName:[{required:!0,message:"请输入租户名称",trigger:"blur"}],superAdmin:[{required:!0,message:"请输入超级管理员姓名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在6到20个字符",trigger:"blur"}]}),q=l({userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],code:[{required:!0,message:"请输入租户编码",trigger:"blur"},{validator:(e,a,l)=>{a&&!/^\d+$/.test(a)?l(new Error("租户编码必须为数字")):l()},trigger:"blur"}],department:[{required:!0,message:"请输入所属部门",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在6到20个字符",trigger:"blur"}]}),C=a(!1),S=a(!1),A=a(null),T=a(null),O=async()=>{if(await A.value.validate())try{C.value=!0;const e=await fetch("/api/tenant/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)}),a=await e.json();I(a)}catch(e){h.error("企业注册失败，请检查网络或服务器状态")}finally{C.value=!1}},F=async()=>{if(await T.value.validate())try{S.value=!0;const e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),a=await e.json();I(a)}catch(e){h.error("用户注册失败，请检查网络或服务器状态")}finally{S.value=!1}},I=e=>{if(!e)return h.error("服务器响应异常，请稍后重试"),!1;switch(e.code){case 200:return h.success(e.message||"注册成功"),N.push("/login"),!0;case 1e3:return h.error(e.message||"租户编码不存在，请检查"),!1;case 1009:return h.error(e.message||"部门不存在，请检查"),!1;default:return h.error(e.message||"注册失败"),!1}},J=()=>{N.push("/login")};return(e,a)=>{const l=r("el-icon"),V=r("el-input"),h=r("el-form-item"),N=r("el-button"),I=r("el-form"),R=r("el-tab-pane"),L=r("el-tabs"),P=r("el-link");return t(),s("div",v,[o(b),d("div",w,[d("div",y,[a[15]||(a[15]=d("div",{class:"register-header"},[d("img",{src:_,alt:"Logo",class:"logo"}),d("h1",null,"InsightFlow"),d("p",null,"注册新账号")],-1)),o(L,{modelValue:z.value,"onUpdate:modelValue":a[11]||(a[11]=e=>z.value=e),class:"register-tabs"},{default:u(()=>[o(R,{label:"企业注册",name:"tenant"},{default:u(()=>[o(I,{ref_key:"tenantFormRef",ref:A,model:U,rules:k,onSubmit:a[4]||(a[4]=i(()=>{},["prevent"]))},{default:u(()=>[o(h,{prop:"tenantName"},{default:u(()=>[o(V,{modelValue:U.tenantName,"onUpdate:modelValue":a[0]||(a[0]=e=>U.tenantName=e),placeholder:"请输入租户名称",size:"large"},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(n))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"superAdmin"},{default:u(()=>[o(V,{modelValue:U.superAdmin,"onUpdate:modelValue":a[1]||(a[1]=e=>U.superAdmin=e),placeholder:"请输入超级管理员姓名",size:"large"},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(p))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"email"},{default:u(()=>[o(V,{modelValue:U.email,"onUpdate:modelValue":a[2]||(a[2]=e=>U.email=e),placeholder:"请输入超级管理员邮箱",size:"large"},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(g))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"password"},{default:u(()=>[o(V,{modelValue:U.password,"onUpdate:modelValue":a[3]||(a[3]=e=>U.password=e),type:"password",placeholder:"请输入登录密码",size:"large","show-password":""},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(f))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(N,{type:"primary",size:"large",class:"register-btn",loading:C.value,onClick:O},{default:u(()=>a[12]||(a[12]=[c(" 注 册 ")])),_:1,__:[12]},8,["loading"])]),_:1},8,["model","rules"])]),_:1}),o(R,{label:"用户注册",name:"user"},{default:u(()=>[o(I,{ref_key:"userFormRef",ref:T,model:j,rules:q,onSubmit:a[10]||(a[10]=i(()=>{},["prevent"]))},{default:u(()=>[o(h,{prop:"userName"},{default:u(()=>[o(V,{modelValue:j.userName,"onUpdate:modelValue":a[5]||(a[5]=e=>j.userName=e),placeholder:"请输入用户名",size:"large"},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(p))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"email"},{default:u(()=>[o(V,{modelValue:j.email,"onUpdate:modelValue":a[6]||(a[6]=e=>j.email=e),placeholder:"请输入邮箱",size:"large"},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(g))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"code"},{default:u(()=>[o(V,{modelValue:j.code,"onUpdate:modelValue":a[7]||(a[7]=e=>j.code=e),placeholder:"请输入租户编码",size:"large",type:"number"},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(n))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"department"},{default:u(()=>[o(V,{modelValue:j.department,"onUpdate:modelValue":a[8]||(a[8]=e=>j.department=e),placeholder:"请输入所属部门",size:"large"},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(n))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"password"},{default:u(()=>[o(V,{modelValue:j.password,"onUpdate:modelValue":a[9]||(a[9]=e=>j.password=e),type:"password",placeholder:"请输入登录密码",size:"large","show-password":""},{prefix:u(()=>[o(l,null,{default:u(()=>[o(m(f))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(N,{type:"primary",size:"large",class:"register-btn",loading:S.value,onClick:F},{default:u(()=>a[13]||(a[13]=[c(" 注 册 ")])),_:1,__:[13]},8,["loading"])]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"]),d("div",x,[o(P,{type:"primary",onClick:J},{default:u(()=>a[14]||(a[14]=[c("返回登录")])),_:1,__:[14]})])])])])}}},[["__scopeId","data-v-fde07dff"]]);export{N as default};
